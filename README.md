# MyBit - ì‹¤ì‹œê°„ ì½”ì¸ ì‹œì„¸ ì¡°íšŒ ì•±

<p>
    <img src="https://github.com/constdreamcoder/Beer/assets/95998675/56def750-b62c-4173-9a6c-e89d355e45c7" width="100%"/>
</p>

<br/>

## MyBit

- ì„œë¹„ìŠ¤ ì†Œê°œ: ì‹¤ì‹œê°„ ì½”ì¸ ì‹œì„¸ ì¡°íšŒ ì•±
- ê°œë°œ ì¸ì›: 1ì¸
- ê°œë°œ ê¸°ê°„: 24.06.05 ~ 24.06.17(ì´ 13ì¼)
- ê°œë°œ í™˜ê²½
  - ìµœì†Œë²„ì „: iOS 15
  - Portrait Orientation ì§€ì›
  - ë¼ì´íŠ¸ ëª¨ë“œ ì§€ì›

<br/>

## ğŸ’ª ì£¼ìš” ê¸°ëŠ¥

- íšŒì› ì¸ì¦: íšŒì› ê°€ì… / ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ
- ì†Œì…œ ë¡œê·¸ì¸: ì¹´ì¹´ì˜¤í†¡ ë¡œê·¸ì¸ / ì• í”Œ ë¡œê·¸ì¸
- í”„ë¡œí•„ ì¡°íšŒ / ìˆ˜ì •
- ì½”ì¸ ê´€ë ¨ ê¸°ëŠ¥
  - ì½”ì¸ ë­í‚¹ ê¸°ëŠ¥
  - ì½”ì¸ ê²€ìƒ‰ / ì¡°íšŒ ê¸°ëŠ¥
  - ì‹¤ì‹œê°„ ì½”ì¸ ì‹œì„¸ ë³€ë™ ì¡°íšŒ ê¸°ëŠ¥
  - ì½”ì¸ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥

<br/>

## ğŸ›  ê¸°ìˆ  ì†Œê°œ

- MVI
- SwiftUI, Combine
- Moya, Alamofire, WebSocket, KakaoOpenSDK
- Kingfisher, DGCharts, Realm, Keychain

<br/>

## ğŸ’» ê¸°ìˆ  ì ìš©
- **MVI** íŒ¨í„´ì„ í†µí•´ ê° êµ¬ì„± ìš”ì†Œì˜ ì»¤ìŠ¤í…€ í”„ë¡œí† ì½œ êµ¬ì„±ì„ í†µí•œ ì—­í• ì„ ë¶„ë¦¬ì™€ ê° í™”ë©´ë³„ ë‹¨ë°©í–¥ ë°ì´í„° íë¦„ êµ¬ì„±
- **PluginType**Â í”„ë¡œí† ì½œ ì¤€ìˆ˜í•˜ëŠ” **Plugin** êµ¬ì„±ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ Logging êµ¬í˜„
- **Interceptor**ë¥¼ í™œìš©í•œ í† í° ê°±ì‹  ë¡œì§ êµ¬ì„±
- **WebSocket**ì„ í™œìš©í•œ ì‹¤ì‹œê°„ ì†Œì¼“ í†µì‹  ë¡œì§ êµ¬ì¶•
- **Realm**ì˜Â **Repository**Â íŒ¨í„´ êµ¬ì„±ìœ¼ë¡œ ë°ì´í„° ì ‘ê·¼ ë¡œì§ ì¶”ìƒí™”
- **Custom Property Wrapper**ë¥¼ í™œìš©í•œ **Keychain** ê´€ë¦¬ ë¡œì§ ì¶”ìƒí™”
- **Kingfisher**ì—ì„œ í† í°ì„ í™œìš©í•œ ì™¸ë¶€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë¡œì§ ëª¨ë“ˆí™”
- **DGCharts** ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œ ì°¨íŠ¸ êµ¬í˜„ìœ¼ë¡œ iOS15 ë²„ì „ ëŒ€ì‘
- **NWPathMonitor**ë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ  ëª¨ë‹ˆí„°ë§ êµ¬ì¶•
- **AuthenticationServices**ì™€ **KakaoOpenSDK**ë¥¼ í†µí•œ ì†Œì…œ ë¡œê·¸ì¸ êµ¬í˜„(**ì• í”Œ/ì¹´ì¹´ì˜¤**)

<br/>

## ğŸ’¾ êµ¬í˜„ ë‚´ìš©

### 1. ì†Œì…œ ë¡œê·¸ì¸

- AuthenticationServicesë¥¼ ì´ìš©í•œ ì• í”Œ ì†Œì…œ ë¡œê·¸ì¸ êµ¬í˜„

  [ğŸ‘‰ ì• í”Œ ì†Œì…œ ë¡œê·¸ì¸ ë¸”ë¡œê·¸ ë§í¬](https://picelworld.tistory.com/73)

- KakaoSDKë¥¼ ì´ìš©í•œ ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ êµ¬í˜„

  [ğŸ‘‰ ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ ë¸”ë¡œê·¸ ë§í¬](https://picelworld.tistory.com/72)

<br/>

### 2. WebSocketì„ í™œìš©í•œ ì‹¤ì‹œê°„ ì½”ì¸ ì‹œì„¸ ë³€ë™ ì¡°íšŒ êµ¬í˜„

[ğŸ‘‰ Socket êµ¬í˜„ ë¸”ë¡œê·¸ ë§í¬](https://picelworld.tistory.com/46)

<details>
<summary><b>ì½”ë“œ</b></summary>
<div markdown="1">

```swift
import Foundation
import Combine

final class WebSocketManager: NSObject {
    static let shared = WebSocketManager()

    private var websocket: URLSessionWebSocketTask?
    private var isOpen = false

    private var timer: Timer?

    var tickerSbj = PassthroughSubject<Ticker, Never>()

    private override init() {}

    func openWebSocket() {
        if let url = URL(string: APIKeys.webSocketBaseURL) {
            let session = URLSession(configuration: .default, delegate: self, delegateQueue: nil)

            websocket = session.webSocketTask(with: url)
            websocket?.resume()

            ping()
        }
    }

    func closeWebSocket() {
        websocket?.cancel(with: .goingAway, reason: nil)
        websocket = nil

        timer?.invalidate()
        timer = nil

        isOpen = false
    }
}

extension WebSocketManager: URLSessionWebSocketDelegate {
    func urlSession(_ session: URLSession, webSocketTask: URLSessionWebSocketTask, didOpenWithProtocol protocol: String?) {
        print("Socket Open")
        isOpen = true

        receiveSocketData()
    }

    func urlSession(_ session: URLSession, webSocketTask: URLSessionWebSocketTask, didCloseWith closeCode: URLSessionWebSocketTask.CloseCode, reason: Data?) {
        print("Socket Close")
        isOpen = false
    }
}

extension WebSocketManager {
    func send(_ string: String) {
        websocket?.send(.string(string)) { error in
            print("Send Error")
        }
    }

    func receiveSocketData() {
        if isOpen {
            websocket?.receive(completionHandler: { [weak self] result in
                guard let self else { return }

                switch result {
                case .success(let success):
                    switch success {
                    case .data(let data):
                        do {
                            let decodedData = try JSONDecoder().decode(Ticker.self, from: data)
                             print(decodedData)
                            tickerSbj.send(decodedData)
                        } catch {
                            print("Decoding Error", error)
                        }
                    case .string(let string):
                        print(string)
                    @unknown default:
                        print("Unknown Default")
                    }
                case .failure(let failure):
                    print("failure", failure)
                }
                receiveSocketData()
            })
        }
    }

    func ping() {
        timer = Timer.scheduledTimer(withTimeInterval: 5.0, repeats: true, block: { [weak self] _ in
            guard let self else { return }
            websocket?.sendPing(pongReceiveHandler: { error in
                if let error = error {
                    print("ping pong error", error.localizedDescription)
                } else {
                    print("ping ping ping")
                }
            })
        })
    }
}

```

</div>
</details>

<br/>

<img src="https://github.com/constdreamcoder/TodoList/assets/95998675/6870c379-bc45-4620-bcb9-a9e6b230a9cb" align="center" width="200">

<br/>

### 3. Keychainì„ í™œìš©í•œ Custom Property Wrapper ì •ì˜

[ğŸ‘‰ Keychain êµ¬í˜„ ë¸”ë¡œê·¸ ë§í¬](https://picelworld.tistory.com/71)

- Keychain Manager ì •ì˜

  ```swift
  struct KeychainManager {

      enum Key: String, CaseIterable {
          case profileImage = "profileImage"
          // ...
      }

      // Keychain ìƒì„±
      static func create(key: Key, value: String) {
        // ...
      }

      // Keychain ì¡°íšŒ
      static func read(key: Key) -> String? {
        // ...
      }

      // Keychain ì‚­ì œ
      static func delete(key: Key) {
        // ...
      }
  }
  ```

- Custom Property Wrapper ì •ì˜

  ```swift
  @propertyWrapper
  struct KeychainStorage: DynamicProperty {

      private let key: KeychainManager.Key
      @State private var data: String

      var wrappedValue: String {
          get {
             // getter ì •ì˜
          }
          nonmutating set {
             // setter ì •ì˜
          }
      }

      var projectedValue: Binding<String> {
          // projectedValue ì •ì˜
      }

      init(wrappedValue: String, _ key: KeychainManager.Key) {
          self.key = key
          if let data = KeychainManager.read(key: key) {
              self.data = data
          } else {
              self.data = wrappedValue
          }
      }
  }
  ```

<br/>

### 4. ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë‹¨ì ˆ ëŒ€ì‘

[ğŸ‘‰ SwiftUIì—ì„œ ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ ëŒ€ì‘ ë¸”ë¡œê·¸ ë§í¬](https://picelworld.tistory.com/79)

<details>
<summary><b>ì½”ë“œ</b></summary>
<div markdown="1">

```swift
import SwiftUI
import Network

final class Network: ObservableObject {

    // NWPathMonitor í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ì„ ì–¸
    let monitor = NWPathMonitor()
    // ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§ ë‹´ë‹¹ Thread
    let queue = DispatchQueue(label: "Monitor")
    @Published private(set) var isConnected: Bool = false

    func checkConnection() {
        // ëª¨ë‹ˆí„°ë§ ì‹œì‘
        monitor.start(queue: queue)
        // ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ ëª¨ë‹ˆí„°ë§ ê²°ê³¼ ë°˜í™˜
        monitor.pathUpdateHandler = { path in

            DispatchQueue.main.async { [weak self] in
                guard let self else { return }

                // ë„¤íŠ¸ì›Œí¬ê°€ ì—°ê²°ë˜ì–´ìˆë‹¤ë©´ isConnectedì— true ê°’ ì „ë‹¬
                isConnected = path.status == .satisfied
            }
        }
    }

    func stop() {
        // ëª¨ë‹ˆí„°ë§ ì·¨ì†Œ
        monitor.cancel()
    }
}
```

</div>
</details>

<br/>

<img src="https://github.com/constdreamcoder/MediaProject/assets/95998675/3c10d3e3-76a6-43ee-90aa-b8c02ba615a6" align="center" width="200">

<br/>

## ğŸ”¥ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

### 1. ì˜¤ë¥˜ ì½”ë“œ ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ Body ìˆ˜ì‹ ì— ë”°ë¥¸ JWT ê°±ì‹ 

ë¬¸ì œìƒí™©

- ì˜¤ë¥˜ ì½”ë“œê°€ Status Codeê°€ ì•„ë‹Œ ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ Bodyì— ìˆ˜ì‹ ë˜ì–´ RequestInterceptor í”„ë¥´í† ì½œì—ì„œ JWT ê°±ì‹ ì„ ìœ„í•œ ì˜¤ë¥˜ ì½”ë“œ êµ¬ë¶„ì´ ì–´ë ¤ì›€

    <img src="https://github.com/constdreamcoder/TodoList/assets/95998675/6a0af3fc-70cb-4770-a781-1380cfe99135">

<br/>

ë¬¸ì œ ì›ì¸ íŒŒì•…

- RequestInterceptor í”„ë¡œí† ì½œì—ì„œ ë„¤íŠ¸ì›Œí¬ ì‘ë‹µì— ì ‘ê·¼í•˜ëŠ” request íŒŒë¼ë¯¸í„°ì˜ response íƒ€ì…ì´ HTTPURLResponseì´ê¸° ë•Œë¬¸ì—, RequestInterceptor í”„ë¡œí† ì½œ ë©”ì„œë“œë¡œ ë‚´ì—ì„œ ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ Bodyì— ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€

<br/>

í•´ê²°ë°©ë²•

- RequestInterceptor í”„ë¡œí† ì½œì˜ request íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ë‹¤ì‹œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ë³´ë‚´ì–´ ì˜¤ë¥˜ ì½”ë“œì— ì ‘ê·¼

    <img src="https://github.com/constdreamcoder/TodoList/assets/95998675/888582cf-6359-40e1-9d9c-bafdcf0b6617">

<br/>

### 2. SwiftUI ë²„ì „ ëŒ€ì‘ - Chart

ë¬¸ì œìƒí™©

- í”„ë¡œì íŠ¸ íƒ€ê²Ÿ ìµœì†Œ ë²„ì „ì´ iOS15ë¡œ ì„¤ì •ë˜ì–´ iOS16ë¶€í„° ì‚¬ìš© ê°€ëŠ¥í•œ SwiftUIì˜ Charts í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš© ë¶ˆê°€

<br/>

ë¬¸ì œ ì›ì¸ íŒŒì•…

- íƒ€ê²Ÿ ìµœì†Œ ë²„ì „ì´ iOS15ì— ë§ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”

<br/>

í•´ê²°ë°©ë²•

- UIKit ê¸°ë°˜ DGCharts ë¼ì´ë¸ŒëŸ¬ë¦¬ ë„ì… ë° UIViewRepresentableì„ ì‚¬ìš©í•˜ì—¬ ChartView êµ¬í˜„

  ```swift
  import DGCharts
  import SwiftUI

  struct ChartView: UIViewRepresentable {

      let entries: [ChartDataEntry]

      func makeUIView(context: Context) -> LineChartView {
          // ChartView ì •ì˜
      }

      func updateUIView(_ uiView: LineChartView, context: Context) {
          // ChartView ì—…ë°ì´íŠ¸
      }
  }

  ```
